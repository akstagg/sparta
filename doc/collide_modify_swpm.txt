"SPARTA WWW Site"_sws - "SPARTA Documentation"_sd - "SPARTA Commands"_sc :c

:link(sws,http://sparta.sandia.gov)
:link(sd,Manual.html)
:link(sc,Section_commands.html#comm)

:line

collide_modify swpm command :h3

[Syntax:]

collide_modify keyword values ...  :pre

one or more keyword/value pairs may be listed :ulb,l
keywords = {swpm} or {reduce}
  {swpm} values = choice Nsplit gamma
    choice = {yes} or {no} to allow particle weights to stochastistically change
    Nsplit = maximum number of particles in a cell to split particles
    gamma = weight transfer functino which is a value > 0
  {reduce} values = reduction_choice Nreduce group_choice Ngroup
    reduction_choice = {ENERGY} or {HEAT} or {STRESS} = how to reduce particles
    Nreduce = minimum number of particles in a cell needed to reduce particles
    group_choice = {BINARY} or {WEIGHT} or {OCTREE} = how to group particles
    Ngroup = maximum number of particles in each group
:ule

[Examples:]

collide_modify swpm yes 16.0 1.0
collide_modify reduce ENERGY 24.0 BINARY 4.0

[Description:]

Set parameters that allow collisions are performed to be modeled according to
the stochastic weight particle method (SWPM) "(Rjasanow05)"_#Rjasanow05. 

The {swpm} keyword enables or disables SWPM. If {no} is specified,
the DSMC model, which is the default, is used.

If {yes} is specified, then SWPM is used. SWPM is typically composed of two
stages: particle splitting and particle reduction. As the name suggests, during
the first stage, particles can split, usually via collisions with one another.
The two candidate particles which are accepted to collide first have their
weights reduced according to a weight transfer function, which is represented
as G. The weight transfer function indicates the amount of weight which is
decremented from each of the particles (parent_ and are transferred to create
two new particles (child). The weight of each childe particle is set as {G} to
conserve mass and copy the velociies of the parent particles. The child particles
then collide according to the molecular model used whereas the parent particles
have their velocities unchanged. 

The {Nsplit} keyword indicates the particle threshold in each cell. If a cell
has less than {Nsplt}, after each split, the child particles have a weight {G}
as described above. If a cell has more than {Nsplit}, {gamma} (which is defined
later) is temporarily changed to zero which implies that {G} = max({g_i},{g_j}).
Notice that one parent particle has all their weight deleted. In this case,
that parent particle is removed, and the net gain in each particle collision
is one particle. 

The {gamma} keyword is used to define the weight transfer function {G}.
The weight transfer function is assumed to have the form
{G} = max({g_i},{g_j})/(1 + {gamma}), where {g_i} and {g_j} are the
particle weights. {gamma} must be a value greater than zero.

The {reduce} keyword points to the second stage of SWPM which is particle
reduction. Particle reduction is the general term where the particles in
a cell are replaced by a smaller sample while conserving certain physical
quantities of interest. If {no} is specificed, particle reduction is not used.
If {yes} is specified, particle reduction is used. In SPARTA, the particles
are first divided into groups and each group of particles is reduced.

The {reduction_choice} keyword is either {ENERGY}, {HEAT}, or {STRESS}.
In all choices, the mass and momentum of each group (and thus the ensemble)
is conserved. If {ENERGY} is chosen, the energy of each group is conserved.
If {HEAT} is chosen, the energy and heat flux in each group is conserved.
If {STRESS} is chosen, the energy, heat flux, and stress tensor is each group
is conserved. 

NOTE: {STRESS} reduction yields six particles instead of two

The {Nreduce} keyword is the minimum number of particles a cell must have to
be eligible for particle reduction. In other words, a cell at any point should
not have more than {Nreduce} particles. {Nreduce} must be greater than 2
if {ENERGY} or {HEAT} reduction is used. If {STRESS} reduction is used,
{Nreduce} must be greater than 6. 

The {group_choice} keyword is either {BINARY} or {OCTREE} or {WEIGHT}.
The grouping particles algorithm involves recursively dividing the particles as
a tree. The root node contains all particles. From each root node, the
particles are divided according to their velocity and contained in leaf nodes.
The leaf nodes recursively divide until the number of particles in that node
is less than {Ngroup} (which is defined later). The number of leaves from
each parent node is two if {BINARY} or {WEIGHT} is used and 8 if {OCTREE} is
used. If {BINARY} grouping is used, the particle are divided by comparing
their velocities with respect to a plane. That plane has a normal in the
same direction of the eigenvector corresponding to the largest eigenvluae of
the covariance matrix of the particle velocities. The {WEIGHT} grouping is
similar to {BINARY} grouping but first divides the particles in the root node
by weight. Three groups are identified which are defined as having small,
medium, and large weights. Particles with large weights are not eligible
to reduce. Medium and small particles are reduced separately. If {OCTREE}
grouping is used, the velocity space is divided into 8 octants centered around
the mean velocity. The particles are then binned into each octant. 

The {Ngroup} keyword is the maximum number of particles that can be in a
group before being reduced. {Ngroup} must be greater than 2 if {ENERGY} or
{HEAT} reduction is used. If {STRESS} reduction is used, {Nreduce} must be
greater than 6. 

:line

[Restrictions:]

The SWPM capabilities are currently limited to monoatomic, homogeneous gases. 

[Related commands:]

"collide"_collide.html, "collide_modify"_collide_modify.html

[Default:]

The option defaults are swpm = no and reduce = no

:line

:link(Rjasanow05)

[(Rjasanow05)] S. Rjasanow, W. Wagner, "Stochastic Numerics for the Boltzmann
Equation," Springer. (2005).
