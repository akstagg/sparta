"SPARTA WWW Site"_sws - "SPARTA Documentation"_sd - "SPARTA Commands"_sc :c

:link(sws,http://sparta.sandia.gov)
:link(sd,Manual.html)
:link(sc,Section_commands.html#comm)

:line

collide_modify swpm command :h3

[Syntax:]

collide_modify keyword values ...  :pre

one or more keyword/value pairs may be listed :ulb,l
keywords = {swpm} or {reduce} :l
  {swpm} values = choice Nsplit gamma
    choice = {yes} or {no} to allow particle weights to stochastistically change
    Nsplit = maximum number of particles in a cell before spitting stops
    gamma = weight transfer function (value > 0)
  {reduce} values = reduction_choice Nreduce group_choice Ngroup
    reduction_choice = {energy} or {heat} or {stress} = how to reduce particles
    Nreduce = minimum number of particles in a cell before reduction occurs
    group_choice = {binary} or {weight} = how to group particles
    Ngroup = maximum number of particles in each group :pre
:ule

[Examples:]

collide_modify swpm yes 16.0 1.0
collide_modify reduce energy 32.0 binary 4.0 :pre

[Description:]

Set parameters that allow collisions are performed to be modeled according to
the stochastic weight particle method (SWPM) "(Rjasanow05)"_#Rjasanow05. 

The {swpm} keyword enables or disables SWPM. If {no} is specified,
the DSMC model, which is the default, is used.

If {yes} is specified, then SWPM is used. SWPM is composed of two
stages: particle splitting and particle reduction. As the name suggests, during
the first stage, particles can split, usually via collisions with one another.
For a colliding pair, each particles splits into two child particles. 
Each child particle copies the velocit of the parent particle.
The weight of each child particle is determined by the weight transfer function, {G}.
The weight of each child particle is set as {G}.
One child from each parent collides with the other child particles.
The remaining two child particles do not collide.

The {Nsplit} keyword indicates number threshold in each cell. If a cell
has less than {Nsplit}, each parent particle can create two particles. 
If a cell has more than {Nsplit}, {G} = max({g_i},{g_j}) temporarily.
Here, {g_i} and {g_j} are the weights of the parent particle.
One parent particle creates one child while the other parent particle
creates two children. If both parent particles have the same weight,
no children are produced.

The {gamma} keyword is used to define the weight transfer function {G}.
The weight transfer function is assumed to have the form
{G} = max({g_i},{g_j})/(1 + {gamma}), where {g_i} and {g_j} are the
particle weights. {gamma} must be a value greater than zero.

The {reduce} keyword is for the particle
reduction. Particle reduction replaces particles in
a cell with a smaller sample while conserving certain physical
quantities of interest. If {no} is specificed, particle reduction is not used.
If {yes} is specified, particle reduction is used. In SPARTA, the particles
are first divided into groups and then each group of particles is reduced.

The {reduction_choice} keyword is either {energy}, {heat}, or {stress}.
In all choices, the mass and momentum of each group
is conserved. If {energy} is chosen, the energy of each group is conserved.
If {heat} is chosen, the energy and heat flux in each group is conserved.
If {stress} is chosen, the energy, heat flux, and stress tensor is each group
is conserved. 

NOTE: {stress} reduction yields six particles instead of two

The {Nreduce} keyword is the minimum number of particles a cell must have to
be eligible for particle reduction. If a cell has more than {Nreduce} particles,
particle reduction (if enabled) is called. Otherwise, particle reduction is skipped.
{Nreduce} must be greater than 2 if {energy} or {heat} reduction is used.
If {stress} reduction is used, {Nreduce} must be greater than 6. 

The {group_choice} keyword is either {binary} or {weight}.
The grouping particles algorithm involves recursively dividing the particles in
a binary tree structure.
The root node contains all particles.
The root node is split into two leaves.
Particles are sorted into each leaf according to their velocity.
The leaf nodes recursively divide until the number of particles in that node
is less than {Ngroup} (which is defined later).
If {binary} grouping is used, the particle are divided by comparing
their velocities with respect to a plane.
The plane has a normal in the same direction of the eigenvector corresponding 
to the largest eigenvluae of the covariance matrix of the particle velocities.
The {weight} grouping first divides the particles in the root node by weight. 
Three groups are identified: small, medium, and large weights.
Particles with large weights are not eligible to reduce.
Medium and small particles are reduced separately.
Each group is then recursively divided using the {binary} grouping. 

The {Ngroup} keyword is the maximum number of particles that can be in a
group before being reduced. {Ngroup} must be greater than 2 if {energy} or
{heat} reduction is used. If {stress} reduction is used, {Ngroup} must be
greater than 6. 

:line

[Restrictions:]

The SWPM capabilities are currently limited to monoatomic, single-species gases.

SWPM can be used with adaptive grids but will cause a significant increase
in the number of particles.

[Related commands:]

"collide"_collide.html, "collide_modify"_collide_modify.html

[Default:]

The option defaults are swpm = no and reduce = no

:line

:link(Rjasanow05)

[(Rjasanow05)] S. Rjasanow, W. Wagner, "Stochastic Numerics for the Boltzmann
Equation," Springer. (2005).
