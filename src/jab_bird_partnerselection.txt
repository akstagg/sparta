// We have a valid list of partners - select one randomly
j = -1;
while (jj == -1) {
  final_subcell = temp_ctr * random->uniform();
  if (subcell_count[neighbor_cells[final_subcell]] > 0)
    jj = subcell_count[neighbor_cells[final_subcell]] * random->uniform();
}
j = subcell_first[neighbor_cells[final_subcell]];
while (jj > 0) {
  j = subcell_next[j];
  jj--;
}
